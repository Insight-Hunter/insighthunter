
name = "insighthunter-main"
compatibility_date     = "2025-03-07"
compatibility_flags    = ["nodejs_compat"]
main                   = "src/index.ts"

[observability]
enabled            = true
head_sampling_rate = 1

# ── Static Assets ─────────────────────────────────────────────────
[assets]
directory = "public"
binding   = "ASSETS"
not_found_handling = "single-page-application"

# ── KV — session store ─────────────────────────────────────────────
[[kv_namespaces]]
binding = "SESSIONS"
id = "60e34ba310ca40c79edec05470c7a271"
preview_id = "60e34ba310ca40c79edec05470c7a271"

# ── D1 ─────────────────────────────────────────────────────────────
[[d1_databases]]
binding       = "DB"
database_name = "insighthunter-db"
database_id   = "aa2b9aa2-f1dd-4fdc-b4b0-d9b4bdc2ea57"

# ── R2 ─────────────────────────────────────────────────────────────
[[r2_buckets]]
binding     = "ASSETS_BUCKET"
bucket_name = "insighthunter-assets"

# ── Service bindings ────────────────────────────────────────────────
[[services]]
binding = "AUTH_SERVICE"
service = "insighthunter-auth"

[[services]]
binding = "BOOKKEEPING_SERVICE"
service = "insighthunter-bookkeeping"

[vars]
ENVIRONMENT = "production"

# Secrets — run: wrangler secret put JWT_SECRET