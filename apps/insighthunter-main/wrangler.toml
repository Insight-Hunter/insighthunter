name = "insighthunter-main"
compatibility_date = "2026-03-01"
compatibility_flags = ["nodejs_als"]
main = "./dist/server/index.ts"

[vars]
ENVIRONMENT = "production"

[observability]
enabled            = true
head_sampling_rate = 1

# ── Static Assets ─────────────────────────────────────────────────
[assets]
directory = "./dist/clients"
binding   = "ASSETS"

# ── KV — session store ─────────────────────────────────────────────
[[kv_namespaces]]
binding = "KV"
id = "60e34ba310ca40c79edec05470c7a271"
preview_id = "60e34ba310ca40c79edec05470c7a271"

# ── D1 ─────────────────────────────────────────────────────────────
[[d1_databases]]
binding       = "DB"
database_name = "insighthunter-db"
database_id   = "aa2b9aa2-f1dd-4fdc-b4b0-d9b4bdc2ea57"

# ── R2 ─────────────────────────────────────────────────────────────
[[r2_buckets]]
binding     = "ASSETS_BUCKET"
bucket_name = "insighthunter-assets"

# ── Service bindings ────────────────────────────────────────────────
[[services]]
binding = "AUTH"
service = "insighthunter-auth"

[[services]]
binding = "BOOKKEEPING_SERVICE"
service = "insighthunter-bookkeeping"
# Secrets — run: wrangler secret put JWT_SECRET